<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<!-- Generated by statdoc (version $version) on $date -->
<head>
<meta charset="utf-8"/>
   <script src="/js/jquery.min.js"></script>
<style>
/*
   STATA smcl formating substitutes
*/
.st_txt {
    color: Black; 
    font-weight: normal;
}
.st_inp {
    color: DarkViolet; 
    font-weight: bold;
}
.st_res {
    color: Blue; 
    font-weight: bold;
}
.st_err {
    color: Red; 
    font-weight: bold;
}
.st_bf {
    font-weight: bold;
}
.st_it {
    font-style: italic;
}

</style>
<script>
var topPos = -1;
var bottomPos = -1;

$(document).ready(function() {
    $.ajax({
        url: "/results"
    }).then(function(data) {
      if ( data.length > 0 ) {
        down(data);        
      }
    });
});

var smallDist = 10;

function up(data) {
  $.each(data.reverse(), function(key, value){  
          $( "pre" ).prepend(value.content);
          topPos = value.line;
          bottomPos = Math.max(value.line, bottomPos);
      });
      $("pre").animate({ scrollTop: smallDist }, "fast");
}
 

function down(data) {
  $.each(data, function(key, value){  
          $( "pre" ).append(value.content);
          topPos = Math.min(value.line, topPos);
          bottomPos = value.line;
      });
      $("pre").animate({ scrollTop: $(document).height()-$(window).height()-smallDist}, "fast");
}
</script>
<script>
 $( "pre" ).scroll(function () {

if ($( "pre" ).scrollTop() <= 0) { 
        // load more on top
        $.ajax({
            url: "/results?from=" + (topPos-10) + "&to=" + topPos
        }).then(function(data) {
          if ( data.length > 0 ) {
            up(data);        
          }
        });     
    } else if ($( "pre" ).scrollTop() + $(window).height() >= $(document).height() ) { 
        // load more on bottom
        // alert( bottomPos );
        $.ajax({
            url: "/results?from=" + (bottomPos+1)
        }).then(function(data) {
          if ( data.length > 0 ) {
            down(data);  
          }      
        });     
    }
 });
 
var intervalId = setInterval(function() {
  if ($( "pre" ).scrollTop() + $( "pre" ).height() >= $(document).height() - smallDist ) { 
        // load more on bottom
        // alert( bottomPos );
        $.ajax({
            url: "/results?from=" + (bottomPos+1)
        }).then(function(data) {
          if ( data.length > 0 ) {
            down(data);  
          }      
        });     
    }
}, 1000);
 
</script>
</head>
<body>
<pre>
</pre>
</body>