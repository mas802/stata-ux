<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<!-- Generated by statdoc (version $version) on $date -->
<head>
<meta charset="utf-8"/>
   <script src="/js/jquery.min.js"></script>
<script>
var delay = (function(){
  var timer = 0;
  return function(callback, ms){
    clearTimeout (timer);
    timer = setTimeout(callback, ms);
  };
})();

function getSelectionStart(o) {
  if (o.createTextRange) {
    var r = document.selection.createRange().duplicate()
    r.moveEnd('character', o.value.length)
    if (r.text == '') return o.value.length
    return o.value.lastIndexOf(r.text)
  } else return o.selectionStart
}
</script>
<body>

<form action="run" target="history" autocorrect="off" autocapitalize="off" autocomplete="off">

<input id="cmdtxt" type="text" name="cmd" size="80" value="" />

<script>
$('#cmdtxt').on('input', function() {
    // do something
        delay(function(){
    var a = document.getElementById('cmdtxt');
    
    $.ajax({
      url: "/cmdparse",
      data: {
        pos: getSelectionStart(a),
        line: $('#cmdtxt').val()
      },
      success: function( data ) {
        $('#cmdline').html( data.data );
      }
    });
    
    }, 300 );
});
</script>

<input type="submit" name='submit' value='go' autocorrect="off" autocapitalize="off" autocomplete="off" />

<a href="graph" target="_blank"> graph</a>


<input type=text id=t1 value=abcd>
<button onclick="alert(document.getElementById('t1').selectionStart)">check position</button>

<div id="cmdline"></div>

</form>